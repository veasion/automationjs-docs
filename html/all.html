<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>综述 | JS自动化测试 -1.0.0 文档</title>
  <link rel="stylesheet" href="assets/fonts.css">
  <link rel="stylesheet" href="assets/style.css">
  <link rel="stylesheet" href="assets/sh.css">
  <link rel="canonical" href="https://nodejs.org/api/all.html">
</head>
<body class="alt apidoc" id="api-section-all">
  <div id="content" class="clearfix">
    <div id="column2" class="interior">
      <div id="intro" class="interior">
        <a href="/" title="返回首页">
          JS自动化测试
        </a>
      </div>
      <ul>
<li><a class="nav-overview" href="overview.html">Overview - 综述</a></li>
<li><a class="nav-qa" href="qa.html">Q&amp;A - 常见问题</a></li>
<li><a class="nav-driver" href="driver.html">Driver - 基础函数</a></li>
<li><a class="nav-element" href="element.html">Element - 元素对象</a></li>
<li><a class="nav-element_ext" href="element_ext.html">ElementExt - 元素函数</a></li>
<li><a class="nav-env" href="env.html">Environment - 环境变量</a></li>
<li><a class="nav-jdbc" href="jdbc.html">Jdbc - 数据库</a></li>
<li><a class="nav-touch" href="touch.html">Touch - 鼠标操作</a></li>
<li><a class="nav-log" href="log.html">Logger - 日志</a></li>
<li><a class="nav-auto" href="auto.html">Auto - 模块及函数</a></li>
<li><a class="nav-demo" href="demo.html">Demo - 示例</a></li>
</ul>

    </div>

    <div id="column1" data-id="all" class="interior">
      <header>
        <h1>JS自动化测试 -1.0.0 文档</h1>
        <div id="gtoc">
          <p>
            <a href="index.html" name="toc">索引</a> |
            <a href="all.html">查看全部</a>
          </p>
        </div>
        <hr>
      </header>

      <div id="toc">
        <h2>目录</h2>
        <ul>
<li><span class="stability_undefined"><a href="#overview">综述</a></span><ul>
<li><span class="stability_undefined"><a href="#overview_1">自动化测试示例：</a></span></li>
<li><span class="stability_undefined"><a href="#overview_target">元素 target 选择器说明：</a></span></li>
</ul>
</li>
<li><span class="stability_undefined"><a href="#qa_q_a">Q &amp; A</a></span><ul>
<li><span class="stability_undefined"><a href="#qa">如何启动程序</a></span></li>
<li><span class="stability_undefined"><a href="#qa_js">启动后如何运行 js 自动化脚本</a></span></li>
<li><span class="stability_undefined"><a href="#qa_js_1">如何指定运行某 js 自动化脚本</a></span></li>
<li><span class="stability_undefined"><a href="#qa_jar">如何以 jar 方式运行</a></span></li>
</ul>
</li>
<li><span class="stability_undefined"><a href="#driver_webdriverbinding">WebDriverBinding</a></span><ul>
<li><span class="stability_undefined"><a href="#driver_open_url">open(url)</a></span></li>
<li><span class="stability_undefined"><a href="#driver_pause_millis">pause(millis)</a></span></li>
<li><span class="stability_undefined"><a href="#driver_sleep_millis">sleep(millis)</a></span></li>
<li><span class="stability_undefined"><a href="#driver_executescript_jscode">executeScript(jsCode)</a></span></li>
<li><span class="stability_undefined"><a href="#driver_executescriptbyparams_jscode_args">executeScriptByParams(jsCode, args)</a></span></li>
<li><span class="stability_undefined"><a href="#driver_command_command">command(command)</a></span></li>
<li><span class="stability_undefined"><a href="#driver_info">info</a></span></li>
<li><span class="stability_undefined"><a href="#driver_assertresult_flag_message">assertResult(flag, message)</a></span></li>
<li><span class="stability_undefined"><a href="#driver_waitforpageloaded_seconds">waitForPageLoaded(seconds)</a></span></li>
<li><span class="stability_undefined"><a href="#driver_iframe_target_fun">iframe(target, fun)</a></span></li>
<li><span class="stability_undefined"><a href="#driver_formatdate_date_pattern">formatDate(date, pattern)</a></span></li>
<li><span class="stability_undefined"><a href="#driver_randcode_length">randCode(length)</a></span></li>
<li><span class="stability_undefined"><a href="#driver_println_message_args">println(message, args)</a></span></li>
<li><span class="stability_undefined"><a href="#driver_calculate_str_n">calculate(str, n)</a></span></li>
<li><span class="stability_undefined"><a href="#driver_writetext_path_context_append_charsetname">writeText(path, context, append, charsetName)</a></span></li>
<li><span class="stability_undefined"><a href="#driver_readtext_pathorurl_charsetname">readText(pathOrUrl, charsetName)</a></span></li>
<li><span class="stability_undefined"><a href="#driver_runnewjs_path">runNewJs(path)</a></span></li>
<li><span class="stability_undefined"><a href="#driver_screenshot_path">screenshot(path)</a></span></li>
<li><span class="stability_undefined"><a href="#driver_getwindowhandle">getWindowHandle()</a></span></li>
<li><span class="stability_undefined"><a href="#driver_opennewwindow">openNewWindow()</a></span></li>
<li><span class="stability_undefined"><a href="#driver_withnewwindow_fun">withNewWindow(fun)</a></span></li>
<li><span class="stability_undefined"><a href="#driver_switchtonextwindow_windowhandle">switchToNextWindow(windowHandle)</a></span></li>
<li><span class="stability_undefined"><a href="#driver_createjdbcconnection_jdbcurl_user_password">createJdbcConnection(jdbcUrl, user, password)</a></span></li>
<li><span class="stability_undefined"><a href="#driver_createmysqlconnection_ip_port_database_user_password">createMysqlConnection(ip, port, database, user, password)</a></span></li>
<li><span class="stability_undefined"><a href="#driver_request_url_method_content_headers">request(url, method, content, headers)</a></span></li>
</ul>
</li>
<li><span class="stability_undefined"><a href="#element_webelementbinding">WebElementBinding</a></span><ul>
<li><span class="stability_undefined"><a href="#element_click">click()</a></span></li>
<li><span class="stability_undefined"><a href="#element_tryclick">tryClick()</a></span></li>
<li><span class="stability_undefined"><a href="#element_attr_attr">attr(attr)</a></span></li>
<li><span class="stability_undefined"><a href="#element_type_key">type(key)</a></span></li>
<li><span class="stability_undefined"><a href="#element_sendkeys_key">sendKeys(key)</a></span></li>
<li><span class="stability_undefined"><a href="#element_text">text()</a></span></li>
<li><span class="stability_undefined"><a href="#element_scrolltocenter">scrollToCenter()</a></span></li>
<li><span class="stability_undefined"><a href="#element_innerhtml">innerHtml()</a></span></li>
<li><span class="stability_undefined"><a href="#element_outerhtml">outerHtml()</a></span></li>
<li><span class="stability_undefined"><a href="#element_value">value()</a></span></li>
<li><span class="stability_undefined"><a href="#element_xpath">xpath()</a></span></li>
<li><span class="stability_undefined"><a href="#element_clear">clear()</a></span></li>
<li><span class="stability_undefined"><a href="#element_setvalue_text">setValue(text)</a></span></li>
<li><span class="stability_undefined"><a href="#element_selectbylabel_value">selectByLabel(value)</a></span></li>
<li><span class="stability_undefined"><a href="#element_selectbyvalue_value">selectByValue(value)</a></span></li>
<li><span class="stability_undefined"><a href="#element_select_label_value">select(label, value)</a></span></li>
<li><span class="stability_undefined"><a href="#element_parent">parent()</a></span></li>
<li><span class="stability_undefined"><a href="#element_parentbytag_tagname">parentByTag(tagName)</a></span></li>
<li><span class="stability_undefined"><a href="#element_childlist">childList()</a></span></li>
<li><span class="stability_undefined"><a href="#element_leftsibling">leftSibling()</a></span></li>
<li><span class="stability_undefined"><a href="#element_rightsibling">rightSibling()</a></span></li>
<li><span class="stability_undefined"><a href="#element_findtext_tagname_text">findText(tagName, text)</a></span></li>
<li><span class="stability_undefined"><a href="#element_tagname">tagName()</a></span></li>
<li><span class="stability_undefined"><a href="#element_isdisplayed">isDisplayed()</a></span></li>
<li><span class="stability_undefined"><a href="#element_touch">touch()</a></span></li>
<li><span class="stability_undefined"><a href="#element_show">show()</a></span></li>
</ul>
</li>
<li><span class="stability_undefined"><a href="#element_webelementbinding_1">WebElementBinding</a></span><ul>
<li><span class="stability_undefined"><a href="#element_click_1">click()</a></span></li>
<li><span class="stability_undefined"><a href="#element_tryclick_1">tryClick()</a></span></li>
<li><span class="stability_undefined"><a href="#element_attr_attr_1">attr(attr)</a></span></li>
<li><span class="stability_undefined"><a href="#element_type_key_1">type(key)</a></span></li>
<li><span class="stability_undefined"><a href="#element_sendkeys_key_1">sendKeys(key)</a></span></li>
<li><span class="stability_undefined"><a href="#element_text_1">text()</a></span></li>
<li><span class="stability_undefined"><a href="#element_scrolltocenter_1">scrollToCenter()</a></span></li>
<li><span class="stability_undefined"><a href="#element_innerhtml_1">innerHtml()</a></span></li>
<li><span class="stability_undefined"><a href="#element_outerhtml_1">outerHtml()</a></span></li>
<li><span class="stability_undefined"><a href="#element_value_1">value()</a></span></li>
<li><span class="stability_undefined"><a href="#element_xpath_1">xpath()</a></span></li>
<li><span class="stability_undefined"><a href="#element_clear_1">clear()</a></span></li>
<li><span class="stability_undefined"><a href="#element_setvalue_text_1">setValue(text)</a></span></li>
<li><span class="stability_undefined"><a href="#element_selectbylabel_value_1">selectByLabel(value)</a></span></li>
<li><span class="stability_undefined"><a href="#element_selectbyvalue_value_1">selectByValue(value)</a></span></li>
<li><span class="stability_undefined"><a href="#element_select_label_value_1">select(label, value)</a></span></li>
<li><span class="stability_undefined"><a href="#element_parent_1">parent()</a></span></li>
<li><span class="stability_undefined"><a href="#element_parentbytag_tagname_1">parentByTag(tagName)</a></span></li>
<li><span class="stability_undefined"><a href="#element_childlist_1">childList()</a></span></li>
<li><span class="stability_undefined"><a href="#element_leftsibling_1">leftSibling()</a></span></li>
<li><span class="stability_undefined"><a href="#element_rightsibling_1">rightSibling()</a></span></li>
<li><span class="stability_undefined"><a href="#element_findtext_tagname_text_1">findText(tagName, text)</a></span></li>
<li><span class="stability_undefined"><a href="#element_tagname_1">tagName()</a></span></li>
<li><span class="stability_undefined"><a href="#element_isdisplayed_1">isDisplayed()</a></span></li>
<li><span class="stability_undefined"><a href="#element_touch_1">touch()</a></span></li>
<li><span class="stability_undefined"><a href="#element_show_1">show()</a></span></li>
</ul>
</li>
<li><span class="stability_undefined"><a href="#all_environmentbinding">EnvironmentBinding</a></span><ul>
<li><span class="stability_undefined"><a href="#all_put_key_value">put(key, value)</a></span></li>
<li><span class="stability_undefined"><a href="#all_putglobal_key_value">putGlobal(key, value)</a></span></li>
<li><span class="stability_undefined"><a href="#all_get_key">get(key)</a></span></li>
<li><span class="stability_undefined"><a href="#all_getstring_key">getString(key)</a></span></li>
<li><span class="stability_undefined"><a href="#all_getordefault_key_defaultval">getOrDefault(key, defaultVal)</a></span></li>
<li><span class="stability_undefined"><a href="#all_remove_key">remove(key)</a></span></li>
<li><span class="stability_undefined"><a href="#all_translate_str">translate(str)</a></span></li>
<li><span class="stability_undefined"><a href="#all_translate_str_object">translate(str, object)</a></span></li>
<li><span class="stability_undefined"><a href="#all_getpath_path">getPath(path)</a></span></li>
<li><span class="stability_undefined"><a href="#all_getsourcepath_path">getSourcePath(path)</a></span></li>
</ul>
</li>
<li><span class="stability_undefined"><a href="#all_key">获取常用按键 KEY</a></span></li>
<li><span class="stability_undefined"><a href="#jdbc_jdbcconnectionbinding">JdbcConnectionBinding</a></span><ul>
<li><span class="stability_undefined"><a href="#jdbc_query_sql_params">query(sql, params)</a></span></li>
<li><span class="stability_undefined"><a href="#jdbc_queryonly_sql_params">queryOnly(sql, params)</a></span></li>
<li><span class="stability_undefined"><a href="#jdbc_update_sql_params">update(sql, params)</a></span></li>
<li><span class="stability_undefined"><a href="#jdbc_insert_sql_params">insert(sql, params)</a></span></li>
<li><span class="stability_undefined"><a href="#jdbc_executeddl_sql">executeDDL(sql)</a></span></li>
<li><span class="stability_undefined"><a href="#jdbc_close">close()</a></span></li>
</ul>
</li>
<li><span class="stability_undefined"><a href="#touch_touchactionsbinding">TouchActionsBinding</a></span><ul>
<li><span class="stability_undefined"><a href="#touch_click">click()</a></span></li>
<li><span class="stability_undefined"><a href="#touch_doubleclick">doubleClick()</a></span></li>
<li><span class="stability_undefined"><a href="#touch_singletap">singleTap()</a></span></li>
<li><span class="stability_undefined"><a href="#touch_doubletap">doubleTap()</a></span></li>
<li><span class="stability_undefined"><a href="#touch_longpress">longPress()</a></span></li>
<li><span class="stability_undefined"><a href="#touch_flick">flick()</a></span></li>
<li><span class="stability_undefined"><a href="#touch_flickbyelement_xoffset_yoffset_speed">flickByElement(xOffset, yOffset, speed)</a></span></li>
<li><span class="stability_undefined"><a href="#touch_down_x_y">down(x, y)</a></span></li>
<li><span class="stability_undefined"><a href="#touch_up_x_y">up(x, y)</a></span></li>
<li><span class="stability_undefined"><a href="#touch_move_x_y">move(x, y)</a></span></li>
<li><span class="stability_undefined"><a href="#touch_scroll_x_y">scroll(x, y)</a></span></li>
<li><span class="stability_undefined"><a href="#touch_scrollbyelement_x_y">scrollByElement(x, y)</a></span></li>
<li><span class="stability_undefined"><a href="#touch_perform">perform()</a></span></li>
</ul>
</li>
<li><span class="stability_undefined"><a href="#log_loggerbinding">LoggerBinding</a></span><ul>
<li><span class="stability_undefined"><a href="#log_debug_message">debug(message)</a></span></li>
<li><span class="stability_undefined"><a href="#log_warn_message">warn(message)</a></span></li>
<li><span class="stability_undefined"><a href="#log_info_message">info(message)</a></span></li>
<li><span class="stability_undefined"><a href="#log_error_message">error(message)</a></span></li>
<li><span class="stability_undefined"><a href="#log_error_message_e">error(message, e)</a></span></li>
<li><span class="stability_undefined"><a href="#log_invokemethod_name_args">invokeMethod(name, args)</a></span></li>
</ul>
</li>
<li><span class="stability_undefined"><a href="#auto">模块及函数</a></span><ul>
<li><span class="stability_undefined"><a href="#auto_1">基础函数</a></span><ul>
<li><span class="stability_undefined"><a href="#auto_auto">auto</a></span></li>
<li><span class="stability_undefined"><a href="#auto_jira">jira</a></span></li>
</ul>
</li>
<li><span class="stability_undefined"><a href="#auto_2">业务模块</a></span><ul>
<li><span class="stability_undefined"><a href="#auto_http">http</a></span></li>
<li><span class="stability_undefined"><a href="#auto_proxy">proxy</a></span></li>
</ul>
</li>
</ul>
</li>
<li><span class="stability_undefined"><a href="#demo_demo">Demo 示例</a></span><ul>
<li><span class="stability_undefined"><a href="#demo">百度搜索 “中国”，进入百度百科结果</a></span></li>
<li><span class="stability_undefined"><a href="#demo_1">起点小说网搜索并下载斗破苍穹</a></span></li>
</ul>
</li>
</ul>

      </div>

      <div id="apicontent">
        <!-- [start-include:overview.md] -->
<h1>综述<span><a class="mark" href="#overview" id="overview">#</a></span></h1>
<p>JS自动化测试 automation_js 使用 <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript">JavaScript</a> 作为脚本语言，目前使用 <a href="http://openjdk.java.net/projects/nashorn/">Java 1.8 Nashorn</a> 作为脚本引擎，支持ES5与部分ES6特性。</p>
<ul>
<li><p>因为是基于JavaScript的，学习API之前建议先学习JavaScript的基本语法和内置对象。</p>
</li>
<li><p>建议通过 <a href="https://www.jetbrains.com/idea/">IntelliJ IDEA</a>  开发，支持 js 代码提示</p>
</li>
<li><p>支持通过 jar 包方式直接运行</p>
</li>
<li><p>浏览器驱动建议使用 <a href="http://npm.taobao.org/mirrors/chromedriver/">chromedriver</a></p>
</li>
</ul>
<p>本文档的章节大致上是以模块来分的，总体上可以分成内置基础函数跟业务扩展函数，包括 元素操作，浏览器窗口操作, http 请求，数据库操作等。</p>
<p>内置函数的部分又可以大致分为基于选择器和基于元素的操作。基于选择器的操作是传统 selenium的方式，通过选择来查找元素。</p>
<p>例如 selenium <code>findElement(By.id(&quot;veasion&quot;))</code>, <code>findElement(By.name(&quot;veasion&quot;))</code>等，在 js 脚本中则是 <code>findOne(&quot;id=veasion&quot;)</code>, <code>findOne(&quot;name=veasion&quot;)</code>。这种方式省略了 By 这个参数，而是通过字符串表示。</p>
<p>其他部分主要包括：</p>
<ul>
<li><p>WebDriverBinding: driver 驱动对象。元素操作、元素查找、窗口、iframe、数据库、http、按键、url等。</p>
</li>
<li><p>WebElementBinding: element 元素对象。操作元素点击、输入、文本、属性、查找等。</p>
</li>
<li><p>EnvironmentBinding: env 环境变量。读取和操作环境变量数据等。</p>
</li>
<li><p>JdbcConnectionBinding: jdbc 数据库连接。操作数据库</p>
</li>
<li><p>Auto: auto 模块及函数封装。</p>
</li>
<li><p>Demo: demo 示例。</p>
</li>
</ul>
<p>除此之外，还支持业务脚本扩展，如业务基础扩展 <code>auto.getIcon()</code> 见 include/auto.js， 模块扩展见 common 目录，依赖扩展见 dependency，脚本代码示例见 script/readme.js。如何运行启动程序相关请见 Q&amp;A</p>
<h2>自动化测试示例：<span><a class="mark" href="#overview_1" id="overview_1">#</a></span></h2>
<div class="signature"><ul>
<li>百度搜索 “中国”，打印出搜索结果</li>
</ul>
</div><pre><code class="lang-js">open(&quot;https://www.baidu.com&quot;);
sendKeys(&#39;id=kw&#39;, &#39;中国&#39;);
click(&quot;css=input[value=&#39;百度一下&#39;]&quot;);
waitForPageLoaded();
let list = findDisplayed(&#39;css=div#content_left &gt; div&#39;);
for (let i in list) {
    println(list[i].text());
}
</code></pre>
<ul>
<li>百度搜索 “中国”，进入百度百科结果</li>
</ul>
<pre><code class="lang-js">// 百度搜索，调用封装函数
baiduSearch(&#39;中国&#39;);
// 获取搜索结果
let list = findDisplayed(&#39;css=div#content_left &gt; div&#39;);
// 变量搜索结果
for (let i in list) {
    let element = list[i].findOne(&quot;css=h3 &gt; a&quot;);
    // 判断结果是否为百度百科
    if (element &amp;&amp; element.text().endsWith(&quot;百度百科&quot;)) {
        // 点击
        element.click();
        // 等待页面加载
        waitForPageLoaded(10);
        // 切换到新打开的窗口
        switchToNextWindow();
        break;
    }
}

function baiduSearch(str) {
    open(&quot;https://www.baidu.com&quot;);
    sendKeys(&#39;id=kw&#39;, str);
    click(&quot;css=input[value=&#39;百度一下&#39;]&quot;);
    waitForPageLoaded(5);
}
</code></pre>
<p>更多示例请见 Demo 示例</p>
<h2>元素 target 选择器说明：<span><a class="mark" href="#overview_target" id="overview_target">#</a></span></h2>
<p><code>id=</code>   根据 id 查找元素</p>
<p><code>name=</code>   根据name查找元素</p>
<p><code>xpath=</code>   根据xpath查找元素</p>
<p><code>css=</code>   根据css查找元素</p>
<p><code>tagName=</code>   根据tagName查找元素</p>
<p><code>className=</code>   根据className查找元素</p>
<p><code>linkText=</code>   根据linkText查找元素</p>
<p>示例：</p>
<pre><code class="lang-html">&lt;div&gt;
    &lt;span id=&quot;wd&quot;&gt;哈哈哈&lt;/span&gt;
    &lt;span name=&quot;text&quot;&gt;嘿嘿&lt;/span&gt;
    &lt;ul class=&quot;test_ul&quot;&gt;
        &lt;li&gt;1&lt;/li&gt;
        &lt;li&gt;2&lt;/li&gt;
    &lt;/ul&gt;
    &lt;a href=&quot;https://www.baidu.com&quot;&gt;百度一下&lt;/a&gt;
&lt;/div&gt;
</code></pre>
<pre><code class="lang-js">// 根据id查询
println(findOne(&quot;id=wd&quot;).text()); // 输出：哈哈哈

// 根据name查询
println(findOne(&quot;name=text&quot;).text()); // 输出：嘿嘿

// 根据xpath查询
println(findOne(&quot;xpath=//div/span[1]&quot;).text()); // 输出：哈哈哈

// 根据css查询
println(findOne(&quot;css=div &gt; span[name=&#39;text&#39;]&quot;).text()); // 输出：嘿嘿

// 根据tagName查询
println(find(&quot;tagName=span&quot;)); // 输出：[&lt;span&gt;哈哈哈&lt;/span&gt;, &lt;span&gt;嘿嘿&lt;/span&gt;]

// 根据className查询
println(find(&quot;className=test_ul&quot;)); // 输出：[&lt;li&gt;1&lt;/li&gt;, &lt;li&gt;2&lt;/li&gt;]

// 根据linkText查询
println(findOne(&quot;linkText=百度一下&quot;).text()); // 输出：百度一下
</code></pre>
<!-- [end-include:overview.md] -->
<!-- [start-include:qa.md] -->
<h1>Q &amp; A<span><a class="mark" href="#qa_q_a" id="qa_q_a">#</a></span></h1>
<h2>如何启动程序<span><a class="mark" href="#qa" id="qa">#</a></span></h2>
<p>首先安装 chrome 浏览器，浏览器访问 chrome://settings/help 打开关于 chrome 页面</p>
<p>找到 chrome 版本，然后打开 <a href="http://npm.taobao.org/mirrors/chromedriver/">chromedriver</a> 下载网站，找到对应版本驱动（版本号匹配要求很严格）</p>
<p>下载对应驱动放到 C:\data\auto\ 目录下（不强烈要求，可以自定义路径）</p>
<p>修改项目下的<code>config.json</code>文件，修改浏览器驱动路径，修改以下条目：</p>
<pre><code class="lang-json">{
    &quot;CHROME_DRIVER_PATH&quot;: &quot;C:\\data\\auto\\chromedriver.exe&quot;
}
</code></pre>
<p>然后运行 <code>cn.veasion.auto.Development</code> 类的 main 方法即可。</p>
<h2>启动后如何运行 js 自动化脚本<span><a class="mark" href="#qa_js" id="qa_js">#</a></span></h2>
<p>由于 Development 类没有明确指定运行文件，所以通过控制台命令运行：</p>
<blockquote>
<p>如运行 script 目录下 crawler.js</p>
</blockquote>
<pre><code>run script/crawler.js
</code></pre><blockquote>
<p>目录层级太多，也可以直接命令行执行（会自动匹配查找）</p>
</blockquote>
<pre><code>&gt; baidu.js
</code></pre><blockquote>
<p>重新运行该 js 命令</p>
</blockquote>
<pre><code>reload
</code></pre><blockquote>
<p>重置脚本引擎</p>
</blockquote>
<pre><code>reset
</code></pre><blockquote>
<p>运行某作者所有 js 脚本 （根据 js 文件中 @author 查找）</p>
</blockquote>
<pre><code>author luozhuowei
</code></pre><blockquote>
<p>退出</p>
</blockquote>
<pre><code>  exit
</code></pre><blockquote>
<p>直接命令行执行 js 脚本</p>
</blockquote>
<pre><code>open(&#39;http://www.baidu.com&#39;)
</code></pre><blockquote>
<p>执行多行 js 脚本</p>
</blockquote>
<pre><code>  &gt;&gt;&gt;
  function hello() {
      log.info(&quot;hello automation js&quot;)
  }
  &gt;&gt;&gt;
</code></pre><blockquote>
<p>打印已执行的历史命令</p>
</blockquote>
<pre><code>  // 上一条命令
  top
  // 前3条命令
  top 3
</code></pre><h2>如何指定运行某 js 自动化脚本<span><a class="mark" href="#qa_js_1" id="qa_js_1">#</a></span></h2>
<p><code>cn.veasion.auto.Development</code> 类的 main 方法代码：</p>
<pre><code class="lang-java">public static void main(String[] args) throws Exception {
    // ...省略其他代码

    // 默认 script 下的脚本文件
    String jsPath = &quot;script/crawler.js&quot;;

    // 指定js文件执行
    JavaScriptCore.execute(driver, env, new File(getFilePath(jsPath)));

    // ...省略其他代码
}
</code></pre>
<h2>如何以 jar 方式运行<span><a class="mark" href="#qa_jar" id="qa_jar">#</a></span></h2>
<p>jar包路径 resources/automation.jar, 运行脚本路径 resources/automation.bat。</p>
<p>安装 jdk 环境，双击 <code>automation.bat</code> 即可运行。</p>
<!-- [end-include:qa.md] -->
<!-- [start-include:driver.md] -->
<h1>WebDriverBinding<span><a class="mark" href="#driver_webdriverbinding" id="driver_webdriverbinding">#</a></span></h1>
<p>driver 模块提供一系列函数，继承 SearchContextBinding 类，用于元素查找，数据库操作等。</p>
<p>该 api 函数可以直接方法访问，如 <code>click(target)</code> 方式调用，等价于 <code>driver.click(target)</code></p>
<p>js 脚本绑定的 java 后台类 cn.veasion.auto.bind.WebDriverBinding</p>
<h2>open(url)<span><a class="mark" href="#driver_open_url" id="driver_open_url">#</a></span></h2>
<div class="signature"><ul>
<li><code>url</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> 网址</li>
</ul>
</div><p>打开页面并等待页面加载</p>
<pre><code class="lang-js">open(&quot;http://www.baidu.com&quot;);
</code></pre>
<h2>pause(millis)<span><a class="mark" href="#driver_pause_millis" id="driver_pause_millis">#</a></span></h2>
<div class="signature"><ul>
<li><code>millis</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" class="type">&lt;number&gt;</a> 毫秒</li>
</ul>
</div><p>暂停多少毫秒，等价于 sleep</p>
<pre><code class="lang-js">pause(500);
</code></pre>
<h2>sleep(millis)<span><a class="mark" href="#driver_sleep_millis" id="driver_sleep_millis">#</a></span></h2>
<div class="signature"><ul>
<li><code>millis</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" class="type">&lt;number&gt;</a> 毫秒</li>
</ul>
</div><p>暂停多少毫秒，等价于 pause</p>
<pre><code class="lang-js">sleep(500);
</code></pre>
<h2>executeScript(jsCode)<span><a class="mark" href="#driver_executescript_jscode" id="driver_executescript_jscode">#</a></span></h2>
<div class="signature"><ul>
<li><code>jsCode</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> js 脚本</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object&gt;</a></li>
</ul>
</div><p>向浏览器驱动执行 js 代码</p>
<pre><code class="lang-js">executeScript(&quot;alert(&#39;hello&#39;);&quot;);
</code></pre>
<h2>executeScriptByParams(jsCode, args)<span><a class="mark" href="#driver_executescriptbyparams_jscode_args" id="driver_executescriptbyparams_jscode_args">#</a></span></h2>
<div class="signature"><ul>
<li><code>jsCode</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> js代码</li>
<li><code>args</code> <span class="type">&lt;array?&gt;</span> 参数</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object&gt;</a></li>
</ul>
</div><p>向浏览器驱动执行 js 代码（带参数）</p>
<pre><code class="lang-js">executeScriptByParams(&quot;arguments[0].click()&quot;, element);
</code></pre>
<h2>command(command)<span><a class="mark" href="#driver_command_command" id="driver_command_command">#</a></span></h2>
<div class="signature"><ul>
<li><code>command</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object&gt;</a> json命令</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object&gt;</a></li>
</ul>
</div><p>执行 json 命令，兼容 js 调用 json 自动化脚本</p>
<pre><code class="lang-js">command({ &quot;command&quot;: &quot;click&quot;, &quot;target&quot;: &quot;css=button&quot; });
command(&#39;{ &quot;command&quot;: &quot;click&quot;, &quot;target&quot;: &quot;css=button&quot; }&#39;);
</code></pre>
<h2>info<span><a class="mark" href="#driver_info" id="driver_info">#</a></span></h2>
<div class="signature"><ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a></li>
</ul>
</div><p>获取当前脚本环境信息。</p>
<h2>assertResult(flag, message)<span><a class="mark" href="#driver_assertresult_flag_message" id="driver_assertresult_flag_message">#</a></span></h2>
<div class="signature"><ul>
<li><code>flag</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type" class="type">&lt;boolean&gt;</a> 是否通过</li>
<li><code>message</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> 断言信息</li>
</ul>
</div><p>断言，当 flag 为 true 时表示断言通过，false 为断言失败抛出异常 message</p>
<pre><code class="lang-js">assertResult(true, &#39;断言测试通过&#39;);
// 断言元素存在
assertResult(findOne(&#39;id=xxx&#39;) != null, &#39;断言元素存在&#39;);
</code></pre>
<h2>waitForPageLoaded(seconds)<span><a class="mark" href="#driver_waitforpageloaded_seconds" id="driver_waitforpageloaded_seconds">#</a></span></h2>
<div class="signature"><ul>
<li><code>seconds</code> <span class="type">&lt;number?&gt;</span> 最大等待秒数</li>
</ul>
</div><p>等待页面加载，通常在页面重新加载或刷新时使用。</p>
<pre><code class="lang-js">waitForPageLoaded(10);
</code></pre>
<h2>iframe(target, fun)<span><a class="mark" href="#driver_iframe_target_fun" id="driver_iframe_target_fun">#</a></span></h2>
<div class="signature"><ul>
<li><code>target</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> 元素选择器</li>
<li><code>fun</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function" class="type">&lt;Function&gt;</a> 函数</li>
</ul>
</div><p>当前浏览器操作切换至 target 元素  iframe 框架里</p>
<pre><code class="lang-js">iframe(&#39;id=iframe&#39;, function () {
    println(findOne(&#39;css=body&#39;).text());
});
</code></pre>
<h2>formatDate(date, pattern)<span><a class="mark" href="#driver_formatdate_date_pattern" id="driver_formatdate_date_pattern">#</a></span></h2>
<div class="signature"><ul>
<li><code>date</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object&gt;</a> 时间 (时间对象/毫秒数)</li>
<li><code>pattern</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> 格式化 format</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a></li>
</ul>
</div><p>格式化时间</p>
<pre><code class="lang-js">// 时间格式化
formatDate(new Date(), &#39;yyyy-MM-dd HH:mm:ss&#39;);
// 毫秒数格式化
formatDate(1607430878907, &#39;yyyy-MM-dd HH:mm:ss&#39;);
</code></pre>
<h2>randCode(length)<span><a class="mark" href="#driver_randcode_length" id="driver_randcode_length">#</a></span></h2>
<div class="signature"><ul>
<li><code>length</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" class="type">&lt;number&gt;</a> 长度</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a></li>
</ul>
</div><p>随机字符串（数字）</p>
<pre><code class="lang-js">randCode(8);
</code></pre>
<h2>println(message, args)<span><a class="mark" href="#driver_println_message_args" id="driver_println_message_args">#</a></span></h2>
<div class="signature"><ul>
<li><code>message</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object&gt;</a> 消息</li>
<li><code>args</code> <span class="type">&lt;array?&gt;</span> 参数</li>
</ul>
</div><p>打印，输出到控制台</p>
<h2>calculate(str, n)<span><a class="mark" href="#driver_calculate_str_n" id="driver_calculate_str_n">#</a></span></h2>
<div class="signature"><ul>
<li><code>str</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> 运算表达式</li>
<li><code>n</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" class="type">&lt;number&gt;</a> 保留几位小数</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> 返回计算结果</li>
</ul>
</div><p>计算器</p>
<pre><code class="lang-js">// 计算，保留两位小数
let result = calculate(&#39;√(3*3)+4.99+(5.99+6.99)*1.06^2&#39;, 2);
println(&#39;计算结果：&#39; + result);
</code></pre>
<h2>writeText(path, context, append, charsetName)<span><a class="mark" href="#driver_writetext_path_context_append_charsetname" id="driver_writetext_path_context_append_charsetname">#</a></span></h2>
<div class="signature"><ul>
<li><code>path</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> 路径</li>
<li><code>context</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> 文本内容</li>
<li><code>append</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type" class="type">&lt;boolean&gt;</a> 是否追加</li>
<li><code>charsetName</code> <span class="type">&lt;string?&gt;</span> 编码，默认UTF-8</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a></li>
</ul>
</div><p>写文本文件</p>
<pre><code class="lang-js">// 写文本文件
writeText(&#39;C:\\Users\\user\\Desktop\\test.txt&#39;, &#39;hello&#39;, false);
// 追加文本文件
writeText(&#39;C:\\Users\\user\\Desktop\\test.txt&#39;, &#39;veasion&#39;, true);
</code></pre>
<h2>readText(pathOrUrl, charsetName)<span><a class="mark" href="#driver_readtext_pathorurl_charsetname" id="driver_readtext_pathorurl_charsetname">#</a></span></h2>
<div class="signature"><ul>
<li><code>pathOrUrl</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> 路径或网址</li>
<li><code>charsetName</code> <span class="type">&lt;string?&gt;</span> 编码，默认UTF-8</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a></li>
</ul>
</div><p>读取文本，可以读本地文本文件和网络文本</p>
<pre><code class="lang-js">// 读取网络文本
readText(&#39;http://www.baidu.com&#39;, &#39;utf-8&#39;);
// 读取本地文本文件
readText(&#39;C:\\Users\\user\\Desktop\\test.txt&#39;, &#39;utf-8&#39;);
</code></pre>
<h2>runNewJs(path)<span><a class="mark" href="#driver_runnewjs_path" id="driver_runnewjs_path">#</a></span></h2>
<div class="signature"><ul>
<li><code>path</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> 路径</li>
</ul>
</div><p>在一个新的环境运行 js 脚本</p>
<pre><code class="lang-js">// 相对路径
runNewJs(env.getSourcePath(&#39;/demo/demo.js&#39;));
// 绝对路径
runNewJs(&#39;D:\Veasion\projects\\automation_testing\src\main\resources\demo\demo.js&#39;);
</code></pre>
<h2>screenshot(path)<span><a class="mark" href="#driver_screenshot_path" id="driver_screenshot_path">#</a></span></h2>
<div class="signature"><ul>
<li><code>path</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> 图片存放路径</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type" class="type">&lt;boolean&gt;</a></li>
</ul>
</div><p>浏览器截图并保存到指定位置</p>
<pre><code class="lang-js">screenshot(&#39;C:\\Users\\user\\Desktop\\temp.png&#39;);
</code></pre>
<h2>getWindowHandle()<span><a class="mark" href="#driver_getwindowhandle" id="driver_getwindowhandle">#</a></span></h2>
<div class="signature"><ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a></li>
</ul>
</div><p>获取当前窗口句柄</p>
<h2>openNewWindow()<span><a class="mark" href="#driver_opennewwindow" id="driver_opennewwindow">#</a></span></h2>
<p>打开并切换到新的窗口</p>
<h2>withNewWindow(fun)<span><a class="mark" href="#driver_withnewwindow_fun" id="driver_withnewwindow_fun">#</a></span></h2>
<div class="signature"><ul>
<li><code>fun</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function" class="type">&lt;Function&gt;</a> 方法</li>
</ul>
</div><p>在新的窗口中执行函数</p>
<pre><code class="lang-js">// 新窗口执行代码
withNewWindow(function () {
    open(&#39;http://www.baidu.com&#39;);
});
</code></pre>
<h2>switchToNextWindow(windowHandle)<span><a class="mark" href="#driver_switchtonextwindow_windowhandle" id="driver_switchtonextwindow_windowhandle">#</a></span></h2>
<div class="signature"><ul>
<li><code>windowHandle</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> 指定窗口句柄，为 null 则切换为下一个窗口</li>
</ul>
</div><p>切换窗口</p>
<pre><code class="lang-js">// 获取当前窗口句柄
let currentHandle = getWindowHandle();
// 切换下一个窗口
switchToNextWindow();
// 切换到指定窗口
switchToNextWindow(currentHandle);
</code></pre>
<h2>createJdbcConnection(jdbcUrl, user, password)<span><a class="mark" href="#driver_createjdbcconnection_jdbcurl_user_password" id="driver_createjdbcconnection_jdbcurl_user_password">#</a></span></h2>
<div class="signature"><ul>
<li><code>jdbcUrl</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> 数据库jdbc连接url</li>
<li><code>user</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> 数据库用户名</li>
<li><code>password</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> 数据库密码</li>
<li><span class="type">&lt;JdbcConnectionBinding&gt;</span></li>
</ul>
</div><p>数据库连接，操作数据库</p>
<pre><code class="lang-js">// 创建连接
let db = createJdbcConnection(&#39;jdbc:mysql://127.0.0.1:3306/user?useUnicode=true&amp;characterEncoding=utf-8&#39;, &#39;root&#39;, &#39;123456&#39;);
// 查询列表
db.query(&#39;select id, user_name, sex from t_user where status = ? limit ?&#39;, [1, 10]);
// 查询单个
db.queryOnly(&#39;select database()&#39;, null);
// 新增
db.insert(&#39;insert into t_user(user_name, sex) values (?, ?)&#39;, [&#39;veasion&#39;, &#39;男&#39;]);
// 修改
db.update(&#39;update t_user set user_name = ? where id = ?&#39;, [&#39;xxx&#39;, 1]);
// 关闭连接
db.close();
</code></pre>
<h2>createMysqlConnection(ip, port, database, user, password)<span><a class="mark" href="#driver_createmysqlconnection_ip_port_database_user_password" id="driver_createmysqlconnection_ip_port_database_user_password">#</a></span></h2>
<div class="signature"><ul>
<li><code>ip</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> 数据库ip地址</li>
<li><code>port</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" class="type">&lt;number&gt;</a> 数据库端口</li>
<li><code>database</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> 数据库</li>
<li><code>user</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> 数据库用户名</li>
<li><code>password</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> 数据库密码</li>
<li><span class="type">&lt;JdbcConnectionBinding&gt;</span></li>
</ul>
</div><p>mysql 数据库连接，操作 mysql 数据库</p>
<pre><code class="lang-js">// mysql 数据库连接
createMysqlConnection(&#39;127.0.0.1&#39;, 3306, &#39;user&#39;, &#39;root&#39;, &#39;123456&#39;);
// 等价于
createJdbcConnection(&#39;jdbc:mysql://127.0.0.1:3306/user?useUnicode=true&amp;characterEncoding=utf-8&#39;, &#39;root&#39;, &#39;123456&#39;);
</code></pre>
<h2>request(url, method, content, headers)<span><a class="mark" href="#driver_request_url_method_content_headers" id="driver_request_url_method_content_headers">#</a></span></h2>
<div class="signature"><ul>
<li><code>url</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> 请求url/uri</li>
<li><code>method</code> <span class="type">&lt;string?&gt;</span> 请求方式 POST/GET 默认GET</li>
<li><code>content</code> <span class="type">&lt;Object?&gt;</span> 请求body内容</li>
<li><code>headers</code> <span class="type">&lt;Object?&gt;</span> 请求头</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object&gt;</a><ul>
<li><code>status</code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" class="type">&lt;number&gt;</a> 请求状态，正常 200</li>
<li><code>success</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type" class="type">&lt;boolean&gt;</a> 请求是否成功</li>
<li><code>data</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> 返回数据，response</li>
<li><code>headers</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object&gt;</a> 返回 headers</li>
<li><code>targetHost</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> 目标服务器ip地址</li>
</ul>
</li>
</ul>
</div><p>http 请求，请求 XHR 接口</p>
<pre><code class="lang-js">// GET请求
let getResp = request(&#39;http://www.baidu.com&#39;, &#39;GET&#39;);
if (getResp.success) {
    log.info(&#39;请求成功：&#39; + getResp.data);
} else {
    log.error(&quot;请求失败，status: &quot; + getResp.status);
}

// POST请求
let postResp = request(&#39;/api/ouser-web/mobileLogin/login.do&#39;, &#39;POST&#39;, { username: &#39;superadmin&#39;, password: &#39;123456&#39;}, { &#39;Content-Type&#39;: &#39;application/json;charset=UTF-8&#39; });
if (postResp.success) {
    log.info(&#39;请求成功：&#39; + JSON.parse(postResp.data));
} else {
    log.error(&quot;请求失败，status: &quot; + postResp.status);
}
</code></pre>
<!-- [end-include:driver.md] -->
<!-- [start-include:element.md] -->
<h1>WebElementBinding<span><a class="mark" href="#element_webelementbinding" id="element_webelementbinding">#</a></span></h1>
<p>element 对象，继承 SearchContextBinding 类，提供一系列元素操作方法。</p>
<p>该 api 函数同元素对象访问，不能直接访问，如 <code>let element = findOne(target)</code> 方式获取元素对象，然后调用函数方法 <code>element.click()</code>，等价于 <code>findOne(target).click()</code></p>
<p>js 脚本绑定的 java 后台类 cn.veasion.auto.bind.WebElementBinding</p>
<h2>click()<span><a class="mark" href="#element_click" id="element_click">#</a></span></h2>
<div class="signature"><ul>
<li><span class="type">&lt;WebElementBinding&gt;</span></li>
</ul>
</div><p>元素点击</p>
<pre><code class="lang-js">let element = findOne(&#39;id=xxx&#39;);
element.click();
</code></pre>
<h2>tryClick()<span><a class="mark" href="#element_tryclick" id="element_tryclick">#</a></span></h2>
<div class="signature"><ul>
<li><span class="type">&lt;WebElementBinding&gt;</span></li>
</ul>
</div><p>点击这个元素区域 ( try 点击，如果失败不会抛出异常 )<br>
该点击函数跟 click 区别是：<br>
click 只能点击可见并且可以点击的元素<br>
tryClick 能点击所有元素，包含不可见元素</p>
<pre><code class="lang-js">element.tryClick();
</code></pre>
<h2>attr(attr)<span><a class="mark" href="#element_attr_attr" id="element_attr_attr">#</a></span></h2>
<div class="signature"><ul>
<li><code>attr</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> 属性名称</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object&gt;</a></li>
</ul>
</div><p>获取元素属性</p>
<pre><code class="lang-js">element.attr(&#39;name&#39;);
</code></pre>
<h2>type(key)<span><a class="mark" href="#element_type_key" id="element_type_key">#</a></span></h2>
<div class="signature"><ul>
<li><code>key</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object&gt;</a> 字符串/按键</li>
<li><span class="type">&lt;WebElementBinding&gt;</span></li>
</ul>
</div><p>向元素发送文字/模拟按键（同 sendKeys 函数）</p>
<pre><code class="lang-js">element.type(&#39;你好&#39;);
</code></pre>
<h2>sendKeys(key)<span><a class="mark" href="#element_sendkeys_key" id="element_sendkeys_key">#</a></span></h2>
<div class="signature"><ul>
<li><code>key</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object&gt;</a> 字符串/按键</li>
<li><span class="type">&lt;WebElementBinding&gt;</span></li>
</ul>
</div><p>向元素发送文字/模拟按键（同 type 函数）</p>
<pre><code class="lang-js">element.sendKeys(&#39;你好&#39;);
</code></pre>
<h2>text()<span><a class="mark" href="#element_text" id="element_text">#</a></span></h2>
<div class="signature"><ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a></li>
</ul>
</div><p>获取元素文本</p>
<h2>scrollToCenter()<span><a class="mark" href="#element_scrolltocenter" id="element_scrolltocenter">#</a></span></h2>
<div class="signature"><ul>
<li><span class="type">&lt;WebElementBinding&gt;</span></li>
</ul>
</div><p>滚动到目标元素</p>
<h2>innerHtml()<span><a class="mark" href="#element_innerhtml" id="element_innerhtml">#</a></span></h2>
<div class="signature"><ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a></li>
</ul>
</div><p>获取元素 inner  html 代码</p>
<h2>outerHtml()<span><a class="mark" href="#element_outerhtml" id="element_outerhtml">#</a></span></h2>
<div class="signature"><ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a></li>
</ul>
</div><p>获取元素 outer  html 代码</p>
<h2>value()<span><a class="mark" href="#element_value" id="element_value">#</a></span></h2>
<div class="signature"><ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a></li>
</ul>
</div><p>获取值。如 input 元素的 value 属性</p>
<pre><code class="lang-js">findOne(&quot;css=input&quot;).value();
</code></pre>
<h2>xpath()<span><a class="mark" href="#element_xpath" id="element_xpath">#</a></span></h2>
<div class="signature"><ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a></li>
</ul>
</div><p>获取元素 xpath</p>
<h2>clear()<span><a class="mark" href="#element_clear" id="element_clear">#</a></span></h2>
<div class="signature"><ul>
<li><span class="type">&lt;WebElementBinding&gt;</span></li>
</ul>
</div><p>清空值。如清空 input 元素的 value 属性</p>
<pre><code class="lang-js">findOne(&quot;css=input&quot;).clear();
// 等价于
findOne(&quot;css=input&quot;).setValue(&#39;&#39;);
</code></pre>
<h2>setValue(text)<span><a class="mark" href="#element_setvalue_text" id="element_setvalue_text">#</a></span></h2>
<div class="signature"><ul>
<li><code>text</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> 字符串</li>
<li><span class="type">&lt;WebElementBinding&gt;</span></li>
</ul>
</div><p>设置值。如设置 input 元素的 value 属性</p>
<pre><code class="lang-js">findOne(&quot;css=input&quot;).setValue(&#39;hello~&#39;);
</code></pre>
<h2>selectByLabel(value)<span><a class="mark" href="#element_selectbylabel_value" id="element_selectbylabel_value">#</a></span></h2>
<div class="signature"><ul>
<li><code>value</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object&gt;</a> 选中值</li>
<li><span class="type">&lt;WebElementBinding&gt;</span></li>
</ul>
</div><p>通过 label 选择下拉框</p>
<pre><code class="lang-js">// &lt;select&gt;
//   &lt;option value=&quot;1&quot;&gt;小明&lt;/option&gt;
//   &lt;option value=&quot;2&quot;&gt;小红&lt;/option&gt;
//   &lt;option value=&quot;3&quot;&gt;小李&lt;/option&gt;
// &lt;/select&gt;

// 选择小红
findOne(&quot;css=select&quot;).selectByLabel(&#39;小红&#39;);
</code></pre>
<h2>selectByValue(value)<span><a class="mark" href="#element_selectbyvalue_value" id="element_selectbyvalue_value">#</a></span></h2>
<div class="signature"><ul>
<li><code>value</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object&gt;</a> 选中值</li>
<li><span class="type">&lt;WebElementBinding&gt;</span></li>
</ul>
</div><p>通过 value 选择下拉框</p>
<pre><code class="lang-js">// &lt;select&gt;
//   &lt;option value=&quot;1&quot;&gt;小明&lt;/option&gt;
//   &lt;option value=&quot;2&quot;&gt;小红&lt;/option&gt;
//   &lt;option value=&quot;3&quot;&gt;小李&lt;/option&gt;
// &lt;/select&gt;

// 选择小红
findOne(&quot;css=select&quot;).selectByValue(&#39;2&#39;);
</code></pre>
<h2>select(label, value)<span><a class="mark" href="#element_select_label_value" id="element_select_label_value">#</a></span></h2>
<div class="signature"><ul>
<li><code>label</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> 选择模式，支持:  index, label, value</li>
<li><code>value</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object&gt;</a> 选中值</li>
<li><span class="type">&lt;WebElementBinding&gt;</span></li>
</ul>
</div><p>选择下拉框</p>
<pre><code class="lang-js">// &lt;select&gt;
//   &lt;option value=&quot;1&quot;&gt;小明&lt;/option&gt;
//   &lt;option value=&quot;2&quot;&gt;小红&lt;/option&gt;
//   &lt;option value=&quot;3&quot;&gt;小李&lt;/option&gt;
// &lt;/select&gt;

// 选择小红
findOne(&quot;css=select&quot;).select(&#39;index&#39;, 1); // 根据下标
findOne(&quot;css=select&quot;).select(&#39;label&#39;, &#39;小红&#39;); // 根据 label
findOne(&quot;css=select&quot;).select(&#39;value&#39;, &#39;2&#39;); // 根据 value
</code></pre>
<h2>parent()<span><a class="mark" href="#element_parent" id="element_parent">#</a></span></h2>
<div class="signature"><ul>
<li><span class="type">&lt;WebElementBinding&gt;</span></li>
</ul>
</div><p>获取父元素</p>
<h2>parentByTag(tagName)<span><a class="mark" href="#element_parentbytag_tagname" id="element_parentbytag_tagname">#</a></span></h2>
<div class="signature"><ul>
<li><code>tagName</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> 元素 tagName</li>
<li><span class="type">&lt;WebElementBinding&gt;</span></li>
</ul>
</div><p>获取指定 tagName 的父元素（向上迭代找指定 tagName 的元素）</p>
<pre><code class="lang-js">element.parentByTag(&quot;html&quot;); // 顶层 html
</code></pre>
<h2>childList()<span><a class="mark" href="#element_childlist" id="element_childlist">#</a></span></h2>
<div class="signature"><ul>
<li><span class="type">&lt;WebElementBinding[]&gt;</span></li>
</ul>
</div><p>子元素集合</p>
<pre><code class="lang-js">let childs = element.childList();
for (let i in childs) {
    println(childs[i]);
}
</code></pre>
<h2>leftSibling()<span><a class="mark" href="#element_leftsibling" id="element_leftsibling">#</a></span></h2>
<div class="signature"><ul>
<li><span class="type">&lt;WebElementBinding[]&gt;</span></li>
</ul>
</div><p>左边兄弟节点集合</p>
<pre><code class="lang-js">// &lt;div&gt;
//     &lt;span&gt;小明&lt;/span&gt;
//     &lt;span id=&quot;xiaohong&quot;&gt;小红&lt;/span&gt;
//     &lt;span&gt;小李&lt;/span&gt;
// &lt;/div&gt;

let element = findOne(&quot;id=xiaohong&quot;);
element.leftSibling(); // [&lt;span&gt;小明&lt;/span&gt;]
</code></pre>
<h2>rightSibling()<span><a class="mark" href="#element_rightsibling" id="element_rightsibling">#</a></span></h2>
<div class="signature"><ul>
<li><span class="type">&lt;WebElementBinding[]&gt;</span></li>
</ul>
</div><p>右边兄弟节点集合</p>
<pre><code class="lang-js">// &lt;div&gt;
//     &lt;span&gt;小明&lt;/span&gt;
//     &lt;span id=&quot;xiaohong&quot;&gt;小红&lt;/span&gt;
//     &lt;span&gt;小李&lt;/span&gt;
// &lt;/div&gt;

let element = findOne(&quot;id=xiaohong&quot;);
element.rightSibling(); // [&lt;span&gt;小李&lt;/span&gt;]
</code></pre>
<h2>findText(tagName, text)<span><a class="mark" href="#element_findtext_tagname_text" id="element_findtext_tagname_text">#</a></span></h2>
<div class="signature"><ul>
<li><code>tagName</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> 元素 tagName，默认 * 所有</li>
<li><code>text</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> 文本</li>
<li><span class="type">&lt;WebElementBinding&gt;</span></li>
</ul>
</div><p>查找元素包含某文字的节点</p>
<pre><code class="lang-js">// &lt;div&gt;
//     &lt;span&gt;小明&lt;/span&gt;
//     &lt;span&gt;小红&lt;/span&gt;
//     &lt;span&gt;小李&lt;/span&gt;
// &lt;/div&gt;

let element = findOne(&quot;css=div&quot;);
element.findText(&quot;span&quot;, &quot;小红&quot;); // &lt;span&gt;小红&lt;/span&gt;
element.findText(&quot;*&quot;, &quot;小红&quot;); // &lt;span&gt;小红&lt;/span&gt;
element.findText(null, &quot;小红&quot;); // &lt;span&gt;小红&lt;/span&gt;
</code></pre>
<h2>tagName()<span><a class="mark" href="#element_tagname" id="element_tagname">#</a></span></h2>
<div class="signature"><ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a></li>
</ul>
</div><p>元素 tagName，如 div/span/input 等</p>
<h2>isDisplayed()<span><a class="mark" href="#element_isdisplayed" id="element_isdisplayed">#</a></span></h2>
<div class="signature"><ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type" class="type">&lt;boolean&gt;</a></li>
</ul>
</div><p>元素是否可见</p>
<h2>touch()<span><a class="mark" href="#element_touch" id="element_touch">#</a></span></h2>
<div class="signature"><ul>
<li><span class="type">&lt;TouchActionsBinding&gt;</span></li>
</ul>
</div><p>触摸操作，返回元素触摸对象</p>
<h2>show()<span><a class="mark" href="#element_show" id="element_show">#</a></span></h2>
<div class="signature"><ul>
<li><span class="type">&lt;WebElementBinding&gt;</span></li>
</ul>
</div><p>页面上突出显示</p>
<!-- [end-include:element.md] -->
<!-- [start-include:element.md] -->
<h1>WebElementBinding<span><a class="mark" href="#element_webelementbinding_1" id="element_webelementbinding_1">#</a></span></h1>
<p>element 对象，继承 SearchContextBinding 类，提供一系列元素操作方法。</p>
<p>该 api 函数同元素对象访问，不能直接访问，如 <code>let element = findOne(target)</code> 方式获取元素对象，然后调用函数方法 <code>element.click()</code>，等价于 <code>findOne(target).click()</code></p>
<p>js 脚本绑定的 java 后台类 cn.veasion.auto.bind.WebElementBinding</p>
<h2>click()<span><a class="mark" href="#element_click_1" id="element_click_1">#</a></span></h2>
<div class="signature"><ul>
<li><span class="type">&lt;WebElementBinding&gt;</span></li>
</ul>
</div><p>元素点击</p>
<pre><code class="lang-js">let element = findOne(&#39;id=xxx&#39;);
element.click();
</code></pre>
<h2>tryClick()<span><a class="mark" href="#element_tryclick_1" id="element_tryclick_1">#</a></span></h2>
<div class="signature"><ul>
<li><span class="type">&lt;WebElementBinding&gt;</span></li>
</ul>
</div><p>点击这个元素区域 ( try 点击，如果失败不会抛出异常 )<br>
该点击函数跟 click 区别是：<br>
click 只能点击可见并且可以点击的元素<br>
tryClick 能点击所有元素，包含不可见元素</p>
<pre><code class="lang-js">element.tryClick();
</code></pre>
<h2>attr(attr)<span><a class="mark" href="#element_attr_attr_1" id="element_attr_attr_1">#</a></span></h2>
<div class="signature"><ul>
<li><code>attr</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> 属性名称</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object&gt;</a></li>
</ul>
</div><p>获取元素属性</p>
<pre><code class="lang-js">element.attr(&#39;name&#39;);
</code></pre>
<h2>type(key)<span><a class="mark" href="#element_type_key_1" id="element_type_key_1">#</a></span></h2>
<div class="signature"><ul>
<li><code>key</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object&gt;</a> 字符串/按键</li>
<li><span class="type">&lt;WebElementBinding&gt;</span></li>
</ul>
</div><p>向元素发送文字/模拟按键（同 sendKeys 函数）</p>
<pre><code class="lang-js">element.type(&#39;你好&#39;);
</code></pre>
<h2>sendKeys(key)<span><a class="mark" href="#element_sendkeys_key_1" id="element_sendkeys_key_1">#</a></span></h2>
<div class="signature"><ul>
<li><code>key</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object&gt;</a> 字符串/按键</li>
<li><span class="type">&lt;WebElementBinding&gt;</span></li>
</ul>
</div><p>向元素发送文字/模拟按键（同 type 函数）</p>
<pre><code class="lang-js">element.sendKeys(&#39;你好&#39;);
</code></pre>
<h2>text()<span><a class="mark" href="#element_text_1" id="element_text_1">#</a></span></h2>
<div class="signature"><ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a></li>
</ul>
</div><p>获取元素文本</p>
<h2>scrollToCenter()<span><a class="mark" href="#element_scrolltocenter_1" id="element_scrolltocenter_1">#</a></span></h2>
<div class="signature"><ul>
<li><span class="type">&lt;WebElementBinding&gt;</span></li>
</ul>
</div><p>滚动到目标元素</p>
<h2>innerHtml()<span><a class="mark" href="#element_innerhtml_1" id="element_innerhtml_1">#</a></span></h2>
<div class="signature"><ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a></li>
</ul>
</div><p>获取元素 inner  html 代码</p>
<h2>outerHtml()<span><a class="mark" href="#element_outerhtml_1" id="element_outerhtml_1">#</a></span></h2>
<div class="signature"><ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a></li>
</ul>
</div><p>获取元素 outer  html 代码</p>
<h2>value()<span><a class="mark" href="#element_value_1" id="element_value_1">#</a></span></h2>
<div class="signature"><ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a></li>
</ul>
</div><p>获取值。如 input 元素的 value 属性</p>
<pre><code class="lang-js">findOne(&quot;css=input&quot;).value();
</code></pre>
<h2>xpath()<span><a class="mark" href="#element_xpath_1" id="element_xpath_1">#</a></span></h2>
<div class="signature"><ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a></li>
</ul>
</div><p>获取元素 xpath</p>
<h2>clear()<span><a class="mark" href="#element_clear_1" id="element_clear_1">#</a></span></h2>
<div class="signature"><ul>
<li><span class="type">&lt;WebElementBinding&gt;</span></li>
</ul>
</div><p>清空值。如清空 input 元素的 value 属性</p>
<pre><code class="lang-js">findOne(&quot;css=input&quot;).clear();
// 等价于
findOne(&quot;css=input&quot;).setValue(&#39;&#39;);
</code></pre>
<h2>setValue(text)<span><a class="mark" href="#element_setvalue_text_1" id="element_setvalue_text_1">#</a></span></h2>
<div class="signature"><ul>
<li><code>text</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> 字符串</li>
<li><span class="type">&lt;WebElementBinding&gt;</span></li>
</ul>
</div><p>设置值。如设置 input 元素的 value 属性</p>
<pre><code class="lang-js">findOne(&quot;css=input&quot;).setValue(&#39;hello~&#39;);
</code></pre>
<h2>selectByLabel(value)<span><a class="mark" href="#element_selectbylabel_value_1" id="element_selectbylabel_value_1">#</a></span></h2>
<div class="signature"><ul>
<li><code>value</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object&gt;</a> 选中值</li>
<li><span class="type">&lt;WebElementBinding&gt;</span></li>
</ul>
</div><p>通过 label 选择下拉框</p>
<pre><code class="lang-js">// &lt;select&gt;
//   &lt;option value=&quot;1&quot;&gt;小明&lt;/option&gt;
//   &lt;option value=&quot;2&quot;&gt;小红&lt;/option&gt;
//   &lt;option value=&quot;3&quot;&gt;小李&lt;/option&gt;
// &lt;/select&gt;

// 选择小红
findOne(&quot;css=select&quot;).selectByLabel(&#39;小红&#39;);
</code></pre>
<h2>selectByValue(value)<span><a class="mark" href="#element_selectbyvalue_value_1" id="element_selectbyvalue_value_1">#</a></span></h2>
<div class="signature"><ul>
<li><code>value</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object&gt;</a> 选中值</li>
<li><span class="type">&lt;WebElementBinding&gt;</span></li>
</ul>
</div><p>通过 value 选择下拉框</p>
<pre><code class="lang-js">// &lt;select&gt;
//   &lt;option value=&quot;1&quot;&gt;小明&lt;/option&gt;
//   &lt;option value=&quot;2&quot;&gt;小红&lt;/option&gt;
//   &lt;option value=&quot;3&quot;&gt;小李&lt;/option&gt;
// &lt;/select&gt;

// 选择小红
findOne(&quot;css=select&quot;).selectByValue(&#39;2&#39;);
</code></pre>
<h2>select(label, value)<span><a class="mark" href="#element_select_label_value_1" id="element_select_label_value_1">#</a></span></h2>
<div class="signature"><ul>
<li><code>label</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> 选择模式，支持:  index, label, value</li>
<li><code>value</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object&gt;</a> 选中值</li>
<li><span class="type">&lt;WebElementBinding&gt;</span></li>
</ul>
</div><p>选择下拉框</p>
<pre><code class="lang-js">// &lt;select&gt;
//   &lt;option value=&quot;1&quot;&gt;小明&lt;/option&gt;
//   &lt;option value=&quot;2&quot;&gt;小红&lt;/option&gt;
//   &lt;option value=&quot;3&quot;&gt;小李&lt;/option&gt;
// &lt;/select&gt;

// 选择小红
findOne(&quot;css=select&quot;).select(&#39;index&#39;, 1); // 根据下标
findOne(&quot;css=select&quot;).select(&#39;label&#39;, &#39;小红&#39;); // 根据 label
findOne(&quot;css=select&quot;).select(&#39;value&#39;, &#39;2&#39;); // 根据 value
</code></pre>
<h2>parent()<span><a class="mark" href="#element_parent_1" id="element_parent_1">#</a></span></h2>
<div class="signature"><ul>
<li><span class="type">&lt;WebElementBinding&gt;</span></li>
</ul>
</div><p>获取父元素</p>
<h2>parentByTag(tagName)<span><a class="mark" href="#element_parentbytag_tagname_1" id="element_parentbytag_tagname_1">#</a></span></h2>
<div class="signature"><ul>
<li><code>tagName</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> 元素 tagName</li>
<li><span class="type">&lt;WebElementBinding&gt;</span></li>
</ul>
</div><p>获取指定 tagName 的父元素（向上迭代找指定 tagName 的元素）</p>
<pre><code class="lang-js">element.parentByTag(&quot;html&quot;); // 顶层 html
</code></pre>
<h2>childList()<span><a class="mark" href="#element_childlist_1" id="element_childlist_1">#</a></span></h2>
<div class="signature"><ul>
<li><span class="type">&lt;WebElementBinding[]&gt;</span></li>
</ul>
</div><p>子元素集合</p>
<pre><code class="lang-js">let childs = element.childList();
for (let i in childs) {
    println(childs[i]);
}
</code></pre>
<h2>leftSibling()<span><a class="mark" href="#element_leftsibling_1" id="element_leftsibling_1">#</a></span></h2>
<div class="signature"><ul>
<li><span class="type">&lt;WebElementBinding[]&gt;</span></li>
</ul>
</div><p>左边兄弟节点集合</p>
<pre><code class="lang-js">// &lt;div&gt;
//     &lt;span&gt;小明&lt;/span&gt;
//     &lt;span id=&quot;xiaohong&quot;&gt;小红&lt;/span&gt;
//     &lt;span&gt;小李&lt;/span&gt;
// &lt;/div&gt;

let element = findOne(&quot;id=xiaohong&quot;);
element.leftSibling(); // [&lt;span&gt;小明&lt;/span&gt;]
</code></pre>
<h2>rightSibling()<span><a class="mark" href="#element_rightsibling_1" id="element_rightsibling_1">#</a></span></h2>
<div class="signature"><ul>
<li><span class="type">&lt;WebElementBinding[]&gt;</span></li>
</ul>
</div><p>右边兄弟节点集合</p>
<pre><code class="lang-js">// &lt;div&gt;
//     &lt;span&gt;小明&lt;/span&gt;
//     &lt;span id=&quot;xiaohong&quot;&gt;小红&lt;/span&gt;
//     &lt;span&gt;小李&lt;/span&gt;
// &lt;/div&gt;

let element = findOne(&quot;id=xiaohong&quot;);
element.rightSibling(); // [&lt;span&gt;小李&lt;/span&gt;]
</code></pre>
<h2>findText(tagName, text)<span><a class="mark" href="#element_findtext_tagname_text_1" id="element_findtext_tagname_text_1">#</a></span></h2>
<div class="signature"><ul>
<li><code>tagName</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> 元素 tagName，默认 * 所有</li>
<li><code>text</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> 文本</li>
<li><span class="type">&lt;WebElementBinding&gt;</span></li>
</ul>
</div><p>查找元素包含某文字的节点</p>
<pre><code class="lang-js">// &lt;div&gt;
//     &lt;span&gt;小明&lt;/span&gt;
//     &lt;span&gt;小红&lt;/span&gt;
//     &lt;span&gt;小李&lt;/span&gt;
// &lt;/div&gt;

let element = findOne(&quot;css=div&quot;);
element.findText(&quot;span&quot;, &quot;小红&quot;); // &lt;span&gt;小红&lt;/span&gt;
element.findText(&quot;*&quot;, &quot;小红&quot;); // &lt;span&gt;小红&lt;/span&gt;
element.findText(null, &quot;小红&quot;); // &lt;span&gt;小红&lt;/span&gt;
</code></pre>
<h2>tagName()<span><a class="mark" href="#element_tagname_1" id="element_tagname_1">#</a></span></h2>
<div class="signature"><ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a></li>
</ul>
</div><p>元素 tagName，如 div/span/input 等</p>
<h2>isDisplayed()<span><a class="mark" href="#element_isdisplayed_1" id="element_isdisplayed_1">#</a></span></h2>
<div class="signature"><ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type" class="type">&lt;boolean&gt;</a></li>
</ul>
</div><p>元素是否可见</p>
<h2>touch()<span><a class="mark" href="#element_touch_1" id="element_touch_1">#</a></span></h2>
<div class="signature"><ul>
<li><span class="type">&lt;TouchActionsBinding&gt;</span></li>
</ul>
</div><p>触摸操作，返回元素触摸对象</p>
<h2>show()<span><a class="mark" href="#element_show_1" id="element_show_1">#</a></span></h2>
<div class="signature"><ul>
<li><span class="type">&lt;WebElementBinding&gt;</span></li>
</ul>
</div><p>页面上突出显示</p>
<!-- [end-include:element.md] -->
<p>_ext
<!-- [start-include:env.md] --></p>
<h1>EnvironmentBinding<span><a class="mark" href="#all_environmentbinding" id="all_environmentbinding">#</a></span></h1>
<p>该类用来操作环境变量，可以直接通过 env 访问。</p>
<p>配置文件 <code>config.json</code> 中的配置会默认加载到 env 全局变量中，可以直接获取，如 <code>env.getString(&#39;USER_NAME&#39;)</code></p>
<h2>put(key, value)<span><a class="mark" href="#all_put_key_value" id="all_put_key_value">#</a></span></h2>
<div class="signature"><ul>
<li><code>key</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> key</li>
<li><code>value</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> value</li>
</ul>
</div><p>存储变量 (当前脚本运行环境，非全局)</p>
<h2>putGlobal(key, value)<span><a class="mark" href="#all_putglobal_key_value" id="all_putglobal_key_value">#</a></span></h2>
<div class="signature"><ul>
<li><code>key</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> key</li>
<li><code>value</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> value</li>
</ul>
</div><p>存储全局变量</p>
<h2>get(key)<span><a class="mark" href="#all_get_key" id="all_get_key">#</a></span></h2>
<div class="signature"><ul>
<li><code>key</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> key</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object&gt;</a></li>
</ul>
</div><p>获取变量</p>
<h2>getString(key)<span><a class="mark" href="#all_getstring_key" id="all_getstring_key">#</a></span></h2>
<div class="signature"><ul>
<li><code>key</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> key</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a></li>
</ul>
</div><p>获取变量</p>
<h2>getOrDefault(key, defaultVal)<span><a class="mark" href="#all_getordefault_key_defaultval" id="all_getordefault_key_defaultval">#</a></span></h2>
<div class="signature"><ul>
<li><code>key</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> key</li>
<li><code>defaultVal</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object&gt;</a> defaultVal 默认值（取不到数据时返回该值）</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object&gt;</a></li>
</ul>
</div><p>获取变量</p>
<h2>remove(key)<span><a class="mark" href="#all_remove_key" id="all_remove_key">#</a></span></h2>
<div class="signature"><ul>
<li><code>key</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> key</li>
</ul>
</div><p>移除当前变量 （本地变量，非全局）</p>
<h2>translate(str)<span><a class="mark" href="#all_translate_str" id="all_translate_str">#</a></span></h2>
<div class="signature"><ul>
<li><code>str</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> 表达式</li>
</ul>
</div><p>解析表达式</p>
<pre><code class="lang-js">env.put(&quot;name&quot;, &quot;veasion&quot;);
env.translate(&quot;hello ${name}&quot;); // hello veasion
</code></pre>
<h2>translate(str, object)<span><a class="mark" href="#all_translate_str_object" id="all_translate_str_object">#</a></span></h2>
<div class="signature"><ul>
<li><code>str</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> 表达式</li>
<li><code>object</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object&gt;</a> 对象</li>
</ul>
</div><p>解析表达式</p>
<pre><code class="lang-js">env.translate(&quot;hello ${name}&quot;, { name: &#39;veasion&#39; }); // hello veasion
</code></pre>
<h2>getPath(path)<span><a class="mark" href="#all_getpath_path" id="all_getpath_path">#</a></span></h2>
<div class="signature"><ul>
<li><code>path</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> 路径</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a></li>
</ul>
</div><p>获取class决定路径</p>
<pre><code class="lang-js">// 如代码在 D:\projects\automation_testing 运行
env.getPath(&#39;/common/proxy.js&#39;); // D:\projects\automation_testing\target\classes\common\proxy.js
</code></pre>
<h2>getSourcePath(path)<span><a class="mark" href="#all_getsourcepath_path" id="all_getsourcepath_path">#</a></span></h2>
<div class="signature"><ul>
<li><code>path</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> 路径</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a></li>
</ul>
</div><p>获取源文件绝对路径</p>
<pre><code class="lang-js">// 如代码在 D:\projects\automation_testing 运行
env.getSourcePath(&#39;/common/proxy.js&#39;); // D:\projects\automation_testing\src\main\resources\common\proxy.js
</code></pre>
<h1>获取常用按键 KEY<span><a class="mark" href="#all_key" id="all_key">#</a></span></h1>
<p>env 可以直接获取常用按键，如回车按键 <code>env.get(&#39;KEY_ENTER&#39;)</code></p>
<p>支持以下按键获取：</p>
<p><code>KEY_BACK_SPACE</code>
<code>KEY_TAB</code>
<code>KEY_ENTER</code>
<code>KEY_SHIFT</code>
<code>KEY_CONTROL</code>
<code>KEY_ALT</code>
<code>KEY_ESCAPE</code>
<code>KEY_PAGE_UP</code>
<code>KEY_PAGE_DOWN</code>
<code>KEY_END</code>
<code>KEY_HOME</code>
<code>KEY_ARROW_LEFT</code>
<code>KEY_ARROW_UP</code>
<code>KEY_ARROW_RIGHT</code>
<code>KEY_ARROW_DOWN</code>
<code>KEY_F12</code></p>
<!-- [end-include:env.md] -->
<!-- [start-include:jdbc.md] -->
<h1>JdbcConnectionBinding<span><a class="mark" href="#jdbc_jdbcconnectionbinding" id="jdbc_jdbcconnectionbinding">#</a></span></h1>
<p>提供数据库操作，对象通过 WebDriverBinding 中的 <code>createJdbcConnection</code> 或 <code>createMysqlConnection</code> 方法创建。</p>
<h2>query(sql, params)<span><a class="mark" href="#jdbc_query_sql_params" id="jdbc_query_sql_params">#</a></span></h2>
<div class="signature"><ul>
<li><code>sql</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> SQL</li>
<li><code>params</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object[]&gt;</a> 参数</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object[]&gt;</a> 返回查询结果列表</li>
</ul>
</div><p>列表查询</p>
<pre><code class="lang-js">// 连接数据库
let db = createMysqlConnection(&#39;127.0.0.1&#39;, 3306, &#39;user&#39;, &#39;root&#39;, &#39;123456&#39;);
// db = createJdbcConnection(&#39;jdbc:mysql://127.0.0.1:3306/user?useUnicode=true&amp;characterEncoding=utf-8&#39;, &#39;root&#39;, &#39;123456&#39;);

// 查询
let list = db.query(&#39;select id, user_name, sex from t_user where status = ? limit ?&#39;, [1, 10]);

for (let i in list) {
    println(list[i]); // { id: 1, userName: &#39;xxx&#39; }
}

db.close();
</code></pre>
<h2>queryOnly(sql, params)<span><a class="mark" href="#jdbc_queryonly_sql_params" id="jdbc_queryonly_sql_params">#</a></span></h2>
<div class="signature"><ul>
<li><code>sql</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> SQL</li>
<li><code>params</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object[]&gt;</a> 参数</li>
</ul>
</div><p>获取单个值</p>
<pre><code class="lang-js">// 连接数据库
let db = createMysqlConnection(&#39;127.0.0.1&#39;, 3306, &#39;user&#39;, &#39;root&#39;, &#39;123456&#39;);
// db = createJdbcConnection(&#39;jdbc:mysql://127.0.0.1:3306/user?useUnicode=true&amp;characterEncoding=utf-8&#39;, &#39;root&#39;, &#39;123456&#39;);

db.queryOnly(&#39;select database()&#39;, null); // user

db.close();
</code></pre>
<h2>update(sql, params)<span><a class="mark" href="#jdbc_update_sql_params" id="jdbc_update_sql_params">#</a></span></h2>
<div class="signature"><ul>
<li><code>sql</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> SQL</li>
<li><code>params</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object[]&gt;</a> 参数</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" class="type">&lt;number&gt;</a> 返回影响条数</li>
</ul>
</div><p>执行增删改</p>
<pre><code class="lang-js">db.update(&#39;update t_user set user_name = ? where id = ?&#39;, [&#39;xxx&#39;, 1]);
</code></pre>
<h2>insert(sql, params)<span><a class="mark" href="#jdbc_insert_sql_params" id="jdbc_insert_sql_params">#</a></span></h2>
<div class="signature"><ul>
<li><code>sql</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> SQL</li>
<li><code>params</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object[]&gt;</a> 参数</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" class="type">&lt;number&gt;</a> 自增ID，无则返回空</li>
</ul>
</div><p>执行新增，返回自增长id</p>
<pre><code class="lang-js">db.insert(&#39;insert into t_user(user_name, sex) values (?, ?)&#39;, [&#39;veasion&#39;, &#39;男&#39;]);
</code></pre>
<h2>executeDDL(sql)<span><a class="mark" href="#jdbc_executeddl_sql" id="jdbc_executeddl_sql">#</a></span></h2>
<div class="signature"><ul>
<li><code>sql</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> SQL</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" class="type">&lt;number&gt;</a> 返回影响条数</li>
</ul>
</div><p>执行DDL</p>
<pre><code class="lang-js">db.executeDDL(&quot;alter table t_user modify `name` varchar(255) not null comment &#39;名称&#39;;&quot;);
</code></pre>
<h2>close()<span><a class="mark" href="#jdbc_close" id="jdbc_close">#</a></span></h2>
<p>关闭连接</p>
<!-- [end-include:jdbc.md] -->
<!-- [start-include:touch.md] -->
<h1>TouchActionsBinding<span><a class="mark" href="#touch_touchactionsbinding" id="touch_touchactionsbinding">#</a></span></h1>
<p>该类用来操作复杂的手势，如元素滚动，元素移动等，对象通过 <code>element.touch()</code> 获取。
目前兼容性差，建议使用 js 自行扩展。</p>
<h2>click()<span><a class="mark" href="#touch_click" id="touch_click">#</a></span></h2>
<div class="signature"><ul>
<li><span class="type">&lt;TouchActionsBinding&gt;</span></li>
</ul>
</div><p>点击</p>
<h2>doubleClick()<span><a class="mark" href="#touch_doubleclick" id="touch_doubleclick">#</a></span></h2>
<div class="signature"><ul>
<li><span class="type">&lt;TouchActionsBinding&gt;</span></li>
</ul>
</div><p>双击</p>
<h2>singleTap()<span><a class="mark" href="#touch_singletap" id="touch_singletap">#</a></span></h2>
<div class="signature"><ul>
<li><span class="type">&lt;TouchActionsBinding&gt;</span></li>
</ul>
</div><p>单次触摸点击</p>
<h2>doubleTap()<span><a class="mark" href="#touch_doubletap" id="touch_doubletap">#</a></span></h2>
<div class="signature"><ul>
<li><span class="type">&lt;TouchActionsBinding&gt;</span></li>
</ul>
</div><p>两次触摸点击</p>
<h2>longPress()<span><a class="mark" href="#touch_longpress" id="touch_longpress">#</a></span></h2>
<div class="signature"><ul>
<li><span class="type">&lt;TouchActionsBinding&gt;</span></li>
</ul>
</div><p>长按</p>
<h2>flick()<span><a class="mark" href="#touch_flick" id="touch_flick">#</a></span></h2>
<div class="signature"><ul>
<li><span class="type">&lt;TouchActionsBinding&gt;</span></li>
</ul>
</div><p>flick</p>
<h2>flickByElement(xOffset, yOffset, speed)<span><a class="mark" href="#touch_flickbyelement_xoffset_yoffset_speed" id="touch_flickbyelement_xoffset_yoffset_speed">#</a></span></h2>
<div class="signature"><ul>
<li><span class="type">&lt;TouchActionsBinding&gt;</span></li>
</ul>
</div><p>flick</p>
<h2>down(x, y)<span><a class="mark" href="#touch_down_x_y" id="touch_down_x_y">#</a></span></h2>
<div class="signature"><ul>
<li><code>x</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" class="type">&lt;number&gt;</a> x坐标</li>
<li><code>y</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" class="type">&lt;number&gt;</a> y坐标</li>
<li><span class="type">&lt;TouchActionsBinding&gt;</span></li>
</ul>
</div><p>down</p>
<h2>up(x, y)<span><a class="mark" href="#touch_up_x_y" id="touch_up_x_y">#</a></span></h2>
<div class="signature"><ul>
<li><code>x</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" class="type">&lt;number&gt;</a> x坐标</li>
<li><code>y</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" class="type">&lt;number&gt;</a> y坐标</li>
<li><span class="type">&lt;TouchActionsBinding&gt;</span></li>
</ul>
</div><p>up</p>
<h2>move(x, y)<span><a class="mark" href="#touch_move_x_y" id="touch_move_x_y">#</a></span></h2>
<div class="signature"><ul>
<li><code>x</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" class="type">&lt;number&gt;</a> x坐标</li>
<li><code>y</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" class="type">&lt;number&gt;</a> y坐标</li>
<li><span class="type">&lt;TouchActionsBinding&gt;</span></li>
</ul>
</div><p>move</p>
<h2>scroll(x, y)<span><a class="mark" href="#touch_scroll_x_y" id="touch_scroll_x_y">#</a></span></h2>
<div class="signature"><ul>
<li><code>x</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" class="type">&lt;number&gt;</a> x坐标</li>
<li><code>y</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" class="type">&lt;number&gt;</a> y坐标</li>
<li><span class="type">&lt;TouchActionsBinding&gt;</span></li>
</ul>
</div><p>滚动</p>
<h2>scrollByElement(x, y)<span><a class="mark" href="#touch_scrollbyelement_x_y" id="touch_scrollbyelement_x_y">#</a></span></h2>
<div class="signature"><ul>
<li><code>x</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" class="type">&lt;number&gt;</a> x坐标</li>
<li><code>y</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" class="type">&lt;number&gt;</a> y坐标</li>
<li><span class="type">&lt;TouchActionsBinding&gt;</span></li>
</ul>
</div><p>滚动</p>
<h2>perform()<span><a class="mark" href="#touch_perform" id="touch_perform">#</a></span></h2>
<div class="signature"><ul>
<li><span class="type">&lt;TouchActionsBinding&gt;</span></li>
</ul>
</div><p>执行</p>
<pre><code class="lang-js">findOne(&quot;id=xxx&quot;).touch().click().move(124, 435).perform();
</code></pre>
<!-- [end-include:touch.md] -->
<!-- [start-include:log.md] -->
<h1>LoggerBinding<span><a class="mark" href="#log_loggerbinding" id="log_loggerbinding">#</a></span></h1>
<p>提供日志记录，可以直接通过 log 访问，如 <code>log.info(&#39;xxx&#39;)</code></p>
<h2>debug(message)<span><a class="mark" href="#log_debug_message" id="log_debug_message">#</a></span></h2>
<div class="signature"><ul>
<li><code>message</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> 消息
debug 日志</li>
</ul>
</div><h2>warn(message)<span><a class="mark" href="#log_warn_message" id="log_warn_message">#</a></span></h2>
<div class="signature"><ul>
<li><code>message</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> 消息
warn 日志</li>
</ul>
</div><h2>info(message)<span><a class="mark" href="#log_info_message" id="log_info_message">#</a></span></h2>
<div class="signature"><ul>
<li><code>message</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> 消息
info 日志</li>
</ul>
</div><h2>error(message)<span><a class="mark" href="#log_error_message" id="log_error_message">#</a></span></h2>
<div class="signature"><ul>
<li><code>message</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> 消息
error 日志</li>
</ul>
</div><h2>error(message, e)<span><a class="mark" href="#log_error_message_e" id="log_error_message_e">#</a></span></h2>
<div class="signature"><ul>
<li><code>message</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> 消息</li>
<li><code>e</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object&gt;</a> 异常
error 日志</li>
</ul>
</div><h2>invokeMethod(name, args)<span><a class="mark" href="#log_invokemethod_name_args" id="log_invokemethod_name_args">#</a></span></h2>
<div class="signature"><ul>
<li><code>name</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" class="type">&lt;string&gt;</a> 方法名</li>
<li><code>args</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" class="type">&lt;Object[]&gt;</a> 方法参数
打印 方法及参数的 info 日志<pre><code class="lang-js">log.invokeMethod(&#39;login&#39;, [&#39;admin&#39;, &#39;123456&#39;]);
// 等价于
log.info(&#39;login(&quot;admin&quot;, &quot;123456&quot;)&#39;);
</code></pre>
</li>
</ul>
</div><!-- [end-include:log.md] -->
<!-- [start-include:auto.md] -->
<h1>模块及函数<span><a class="mark" href="#auto" id="auto">#</a></span></h1>
<p>基于 JS 自动化测试框架扩展的业务模块及函数，方便直接调用封装函数解决问题。</p>
<p>如登录 <code>auto.randMobile()</code> 等。</p>
<ul>
<li>业务基础函数在 include 目录下（包含auto / jira 等对象定义）</li>
<li>业务模块在 common 目录下（包含http/代理等模块）</li>
<li>业务数据依赖在 dependency 目录下（可以直接依赖基础数据）</li>
</ul>
<h2>基础函数<span><a class="mark" href="#auto_1" id="auto_1">#</a></span></h2>
<h3>auto<span><a class="mark" href="#auto_auto" id="auto_auto">#</a></span></h3>
<p>auto 对象提供常用的自动化函数，具体查看  include/auto.js</p>
<pre><code class="lang-js">// 加载 http 模块
auto.loadCommon(&#39;http&#39;);

// 依赖demo数据
auto.dependency(&#39;demo&#39;, {name: &#39;xxx&#39;});

// table 滚动到最右边
auto.scroll(findOne(&#39;css=.el-table__body-wrapper&#39;), null, 0);
</code></pre>
<h3>jira<span><a class="mark" href="#auto_jira" id="auto_jira">#</a></span></h3>
<p>jira 对象提供 JIRA 操作，具体函数见  include/jira.js</p>
<pre><code class="lang-js">// 登录 jira
jira.login();

// 提bug
jira.createIssue(&#39;测试&#39;, &#39;程序有bug&#39;);
</code></pre>
<h2>业务模块<span><a class="mark" href="#auto_2" id="auto_2">#</a></span></h2>
<p>调用模块需要先引用模块，如 <code>auto.loadCommon(&#39;http&#39;);</code> 建议放代码最前面。</p>
<h3>http<span><a class="mark" href="#auto_http" id="auto_http">#</a></span></h3>
<p>http 模块，主要操作HTTP请求，如GET/POST请求，具体函数见 common/http.js</p>
<pre><code class="lang-js">auto.loadCommon(&#39;http&#39;);

http.get(&#39;http://www.baidu.com&#39;);

http.post(&#39;/api/ouser-web/mobileLogin/login.do&#39;, { username: &#39;superadmin&#39;, password: &#39;123456&#39;});

let response = http.request(&#39;/oms-web/so/list.do&#39;, &#39;POST&#39;);
println(&#39;response: &#39; + response.data);
let ut = http.getCookie(&#39;ut&#39;);
println(&#39;ut: &#39; + ut);
</code></pre>
<h3>proxy<span><a class="mark" href="#auto_proxy" id="auto_proxy">#</a></span></h3>
<p>proxy 模块，主要用于 js 对象代理，具体函数见 common/proxy.js</p>
<pre><code class="lang-js">auto.loadCommon(&#39;proxy&#39;);

let p = new ProxyAdapter({}, function (obj, name, args, apply) {
    println(name + &#39;方法被代理了 --before&#39;);
    let result = apply();
    println(name + &#39;方法被代理了 --after&#39;);
    return result;
});

p.hello = function() {
    println(&#39;hello~&#39;);
}

p.hello();
// hello方法被代理了 --before
// hello~
// hello方法被代理了 --after
</code></pre>
<!-- [end-include:auto.md] -->
<!-- [start-include:demo.md] -->
<h1>Demo 示例<span><a class="mark" href="#demo_demo" id="demo_demo">#</a></span></h1>
<h2>百度搜索 “中国”，进入百度百科结果<span><a class="mark" href="#demo" id="demo">#</a></span></h2>
<pre><code class="lang-js">// demo 演示 中国百度百科
// @author luozhuowei

// 百度 &quot;中国&quot;
baiduSearch(&#39;中国&#39;);
// 获取搜索结果
let list = findDisplayed(&#39;css=div#content_left &gt; div&#39;);
// 变量搜索结果
for (let i in list) {
    let element = list[i].findOne(&quot;css=h3 &gt; a&quot;);
    // 判断结果是否为百度百科
    if (element &amp;&amp; element.text().endsWith(&quot;百度百科&quot;)) {
        // 点击
        element.click();
        // 等待页面加载
        waitForPageLoaded(10);
        // 切换到新打开的窗口
        switchToNextWindow();
        break;
    }
}

function baiduSearch(str) {
    open(&quot;https://www.baidu.com&quot;);
    sendKeys(&#39;id=kw&#39;, str);
    click(&quot;css=input[value=&#39;百度一下&#39;]&quot;);
    waitForPageLoaded(5);
}
</code></pre>
<h2>起点小说网搜索并下载斗破苍穹<span><a class="mark" href="#demo_1" id="demo_1">#</a></span></h2>
<pre><code class="lang-js">// demo 演示 爬小说
// @author luozhuowei

let bookName = &#39;斗破苍穹&#39;;
// 爬取前5章
let chapterCount = 5;
// 保存到桌面
let savePath = env.getString(&#39;DESKTOP_DIR&#39;) + &#39;\\斗破苍穹.txt&#39;;

log.info(&#39;正在下载: &#39; + bookName);
log.info(&#39;保存路径: &#39; + savePath);

// 起点小说
open(&#39;https://www.qidian.com&#39;);
// 搜索
sendKeys(&#39;id=s-box&#39;, bookName);
tryClick(&#39;id=search-btn&#39;);
switchToNextWindow();
waitForPageLoaded();
sleep(500);

// 点击搜索结果
findOne(&#39;css=#result-list&#39;).findOne(&#39;linkText=&#39; + bookName).tryClick();
switchToNextWindow();
waitForPageLoaded();

// 点击“免费试读”
findText(&#39;a&#39;, &#39;免费试读&#39;, false).tryClick();
waitForPageLoaded();

// 关闭广告弹窗
tryClick(&#39;css=a.lbf-panel-close&#39;);
sleep(200);

for (let i = 0; i &lt; chapterCount; i++) {
    // 小说主体
    let bookBody = findOne(&#39;css=#j_chapterBox div.main-text-wrap&#39;);
    // 移除评论
    executeScript(&quot;document.querySelectorAll(&#39;span.review-count&#39;).forEach(item =&gt; item.remove());&quot;);
    // 小说标题
    let title = bookBody.findOne(&#39;css=.j_chapterName&#39;).text();
    log.info(title);
    // 小说内容
    let context = bookBody.findOne(&#39;css=div.read-content.j_readContent&#39;).text().replace(/[\n]/g, &#39;\r\n\r\n&#39;);
    // 保存小说
    writeText(savePath, title + &#39;\r\n\r\n&#39; + context + &#39;\r\n\r\n\r\n\r\n&#39;, true);
    // 下一章
    let nextPage = findOne(&#39;id=j_chapterNext&#39;);
    if (nextPage) {
        nextPage.tryClick();
        waitForPageLoaded();
        sleep(200);
    } else {
        break;
    }
}
</code></pre>
<!-- [end-include:demo.md] -->

      </div>
    </div>
  </div>
  <script src="assets/sh_main.js"></script>
  <script src="assets/sh_javascript.min.js"></script>
  <script>highlight(undefined, undefined, 'pre');</script>
  <!-- __TRACKING__ -->
</body>
</html>